<head> <title>Mania Converter</title> <meta charset="UTF-8"> </header>
<body>
	<style>
	body{background-color: rgb(66, 245, 152);}
	.imageA {
		position: absolute;
		left: 0px;
		top: 0px;
		width: 1920px;
		height: 1080px;
	}
	.b0{
		font-size: 20px;
		height: 50px;
		width: 200px;
		position: absolute;
		left: 350px;
		top: 100px;
	}
	.b1{
		font-size: 20px;
		height: 50px;
		width: 200px;
		position: absolute;
		left: 550px;
		top: 100px;
	}
	.b2{
		font-size: 20px;
		height: 50px;
		width: 200px;
		position: absolute;
		left: 750px;
		top: 100px;
	}
	.b3{
		font-size: 20px;
		height: 50px;
		width: 200px;
		position: absolute;
		left: 950px;
		top: 100px;
	}
	</style>
	<h1 style="font-family:verdana;position:absolute;left:535px;top:-20px;">Mania Converter Online!</h1>
	<p style="font-size:20px;"></p>
	<!--<img src="c.gif" class="imageA">-->

	<input style="position:absolute;left:400px;top:50px;" type="file" id="inputfile" accept=".osu,.json"/>
	<br>
	<button id="downloader" style="position:absolute;left:100px;top:50px;width:300px;height:22px;opacity:0;" onclick="da()" disabled>Download file</button>

	<input id="b0" class="b0" type="button" value="FNF" onclick="updateMB(0)">
	<input id="b1" class="b1" type="button" value="osu!mania to FNF" onclick="updateMB(1)">
	<input id="b2" class="b2" type="button" value="FNF to osu!mania" onclick="updateMB(2)">
	<input id="b3" class="b3" type="button" value="osu!mania" onclick="updateMB(3)">
	<!--<input class="t1" type="text" placeholder="Key Count (Mania)">-->
	<h1 class="coola0" style="font-family:verdana;font-size:22px;position:absolute;left:10px;top:157px;">IGNORE NOTES</h1>
	<input class="coola0" style="position:absolute;left:220px;top:170px;width:200px;height:30px;font-size:18px;" type="text" value="Hurt Note" id="in">

	<h1 class="coola1" style="font-family:verdana;font-size:16.5px;position:absolute;left:10px;top:203.5px;">KEY COUNT (MANIA)</h1>
	<select class="coola1" style="position:absolute;left:220px;top:210px;width:200px;height:30px;font-size:18px;" type="text" id="kc">
		<option value="1">1 Key</option>
		<option value="2">2 Key</option>
		<option value="3">3 Key</option>
		<option value="4" selected>4 Key</option>
		<option value="5">5 Key</option>
		<option value="6">6 Key</option>
		<option value="7">7 Key</option>
		<option value="8">8 Key</option>
		<option value="9">9 Key</option>
	</select>

	<h1 class="coola3" style="font-family:verdana;font-size:25px;position:absolute;left:133px;top:232.5px;">SIDE</h1>
	<select class="coola3" style="position:absolute;left:220px;top:250px;width:200px;height:30px;font-size:18px;" type="text" value="0" id="s">
		<option value="0">All</option>
		<option value="1">Boyfriend</option>
		<option value="2">Opponent</option>
	</select>

	<h1 class="coola2" style="font-family:verdana;font-size:25px;position:absolute;left:70px;top:273px;">PLAYER 1</h1>
	<input class="coola2" style="position:absolute;left:220px;top:290px;width:200px;height:30px;font-size:18px;" type="text" value="bf" id="p1">

	<h1 class="coola2" style="font-family:verdana;font-size:25px;position:absolute;left:70px;top:313px;">PLAYER 2</h1>
	<input class="coola2" style="position:absolute;left:220px;top:330px;width:200px;height:30px;font-size:18px;" type="text" value="pico" id="p2">

	<h1 class="coola2" style="font-family:verdana;font-size:25px;position:absolute;left:70px;top:353px;">PLAYER 3</h1>
	<input class="coola2" style="position:absolute;left:220px;top:370px;width:200px;height:30px;font-size:18px;" type="text" value="gf" id="p3">

	<h1 class="coola2" style="font-family:verdana;font-size:25px;position:absolute;left:112.5px;top:393px;">STAGE</h1>
	<input class="coola2" style="position:absolute;left:220px;top:410px;width:200px;height:30px;font-size:18px;" type="text" value="stage" id="st">

	<h1 class="coola2" style="font-family:verdana;font-size:23.5px;position:absolute;left:9px;top:434px;">SCROLL SPEED</h1>
	<h1 class="coola2" style="font-family:verdana;font-size:20px;position:absolute;left:367.5px;top:441px;" id="rt0">3</h1>
	<input class="coola2" style="position:absolute;left:220px;top:450px;width:140px;height:30px;font-size:18px;" id="r0" oninput="ur(0)" type="range" min="0.01" max="10" step="0.01" value="3">

	<h1 class="coola2" style="font-family:verdana;font-size:25px;position:absolute;left:143px;top:474px;">BPM</h1>
	<h1 class="coola2" style="font-family:verdana;font-size:20px;position:absolute;left:367.5px;top:481px;" id="rt1">150</h1>
	<input class="coola2" style="position:absolute;left:220px;top:490px;width:140px;height:30px;font-size:18px;" id="r1" oninput="ur(1)" type="range" min="1" max="999" step="1" value="150">

	<h1 class="coola2" style="font-family:verdana;font-size:23px;position:absolute;left:10px;top:519px;">NEEDS VOICES</h1>
	<input class="coola2" style="position:absolute;left:161px;top:530px;width:140px;height:30px;font-size:18px;" type="checkbox" id="nv">

	<h1 class="coola2" style="font-family:verdana;font-size:25px;position:absolute;left:30px;top:556px;">GF SECTION</h1>
	<input class="coola2" style="position:absolute;left:161px;top:570px;width:140px;height:30px;font-size:18px;" type="checkbox" id="gs">

	<h1 class="coola2" style="font-family:verdana;font-size:25px;position:absolute;left:62px;top:596px;">ALT ANIM</h1>
	<input class="coola2" style="position:absolute;left:161px;top:610px;width:140px;height:30px;font-size:18px;" type="checkbox" id="aa">

	<h1 class="coola2" style="font-family:verdana;font-size:17.5px;position:absolute;left:8px;top:645px;">MUST HIT SECTION</h1>
	<input class="coola2" style="position:absolute;left:161px;top:650px;width:140px;height:30px;font-size:18px;" type="checkbox" checked id="mhs">

	<h1 class="coola3" style="font-family:verdana;font-size:18px;position:absolute;left:14px;top:682px;">AUDIO FILE NAME</h1>
	<input class="coola3" style="position:absolute;left:220px;top:690px;width:200px;height:30px;font-size:18px;" type="text" value="audio.mp3" id="afn">

	<h1 class="coola3" style="font-family:verdana;font-size:25px;position:absolute;left:94px;top:713px;">ARTIST</h1>
	<input class="coola3" style="position:absolute;left:220px;top:730px;width:200px;height:30px;font-size:18px;" type="text" value="ManiaConverter" id="ar">

	<h1 class="coola3" style="font-family:verdana;font-size:25px;position:absolute;left:66px;top:753px;">CREATOR</h1>
	<input class="coola3" style="position:absolute;left:220px;top:770px;width:200px;height:30px;font-size:18px;" type="text" value="ManiaConverter"  id="cr">

	<h1 class="coola3" style="font-family:verdana;font-size:25px;position:absolute;left:28px;top:793px;">DIFFICULTY</h1>
	<input class="coola3" style="position:absolute;left:220px;top:810px;width:200px;height:30px;font-size:18px;" type="text" value="Normal" id="diff">

	<h1 class="coola3" style="font-family:verdana;font-size:21px;position:absolute;left:9px;top:839px;">HP DRAIN RATE</h1>
	<h1 class="coola3" style="font-family:verdana;font-size:20px;position:absolute;left:367.5px;top:841px;" id="rt2">8</h1>
	<input class="coola3" style="position:absolute;left:220px;top:850px;width:140px;height:30px;font-size:18px;" id="r2" oninput="ur(2)" type="range" min="0.1" max="10" step="0.1" value="8">

	<h1 class="coola3" style="font-family:verdana;font-size:17px;position:absolute;left:8px;top:884px;">HITSOUND VOLUME</h1>
	<h1 class="coola3" style="font-family:verdana;font-size:20px;position:absolute;left:367.5px;top:881px;" id="rt3">20</h1>
	<input class="coola3" style="position:absolute;left:220px;top:890px;width:140px;height:30px;font-size:18px;" id="r3" oninput="ur(3)" type="range" min="0" max="100" step="1" value="20">

	<h1 class="coola1" style="font-family:verdana;font-size:17px;position:absolute;left:8px;top:924px;">FROM KEY DEFAULT</h1>
	<select class="coola1" style="position:absolute;left:220px;top:930px;width:140px;height:30px;font-size:18px;"  id="fkd">
		<option value="1">1 Key</option>
		<option value="2">2 Key</option>
		<option value="3">3 Key</option>
		<option value="4" selected>4 Key</option>
		<option value="5">5 Key</option>
		<option value="6">6 Key</option>
		<option value="7">7 Key</option>
		<option value="8">8 Key</option>
		<option value="9">9 Key</option>
	</select>

	<h1 class="coola1" style="font-family:verdana;font-size:17px;position:absolute;left:36px;top:964px;">TO KEY DEFAULT</h1>
	<select class="coola1" style="position:absolute;left:220px;top:970px;width:140px;height:30px;font-size:18px;"  id="tkd">
		<option value="1">1 Key</option>
		<option value="2">2 Key</option>
		<option value="3">3 Key</option>
		<option value="4">4 Key</option>
		<option value="5">5 Key</option>
		<option value="6" selected>6 Key</option>
		<option value="7">7 Key</option>
		<option value="8">8 Key</option>
		<option value="9">9 Key</option>
	</select>
	<input id="start" style="position:absolute;height:50px;width:300px;left:600px;bottom:100px;font-size:20px;opacity:0;" type="button" value="START CONVERTING" onclick="convert()" disabled>
</body>
<html>

<script>
	updateMB(199);

	var data = null;
	var mode = null;
	function da()
	{
		if (data != null)
		{
			//data = data + '\nsuk';
			//console.log(data);
			download(data, 'c.txt', 'text/plain');
		}
	}
	document.getElementById('inputfile').addEventListener('change', function() {
		var fr = new FileReader();
		fr.onload = function()
		{
			data = fr.result;
			console.log(JSON.parse(data).song.song);
			document.getElementById('inputfile').disabled = true;
			document.getElementById('inputfile').style.opacity = 0;
			if (mode != null)
			{
				document.getElementById('start').disabled = false;
				document.getElementById('start').style.opacity = 1;
			}
		}
		fr.readAsText(this.files[0]);
	})

	function ur(d)
	{
		switch(d)
		{
			case 0:
				document.getElementById('rt0').textContent = document.getElementById('r0').value;
				//console.log(document.getElementById('kc').value);
				break;
			case 1:
				document.getElementById('rt1').textContent = document.getElementById('r1').value;
				break;
			case 2:
				document.getElementById('rt2').textContent = document.getElementById('r2').value;
				break;
			case 3:
				document.getElementById('rt3').textContent = document.getElementById('r3').value;
				break;
		}
	}

	function runconv()
	{
		if (data != null)
		{
			console.log(JSON.parse(data).song.song);
			convert();
		}
	}
	
	function download(content, filename, contentType)
	{
		if(!contentType) contentType = 'application/octet-stream';
			var a = document.createElement('a');
			var blob = new Blob([content], {'type':contentType});
			a.href = window.URL.createObjectURL(blob);
			a.download = filename;
			a.click();

			data = null;
			document.getElementById('inputfile').disabled = false;
			document.getElementById('inputfile').style.opacity = 1;
			document.getElementById('downloader').disabled = true;
			document.getElementById('downloader').style.left = 100;
			document.getElementById('downloader').style.opacity= 0;
			document.getElementById('start').disabled = true;
			document.getElementById('start').style.opacity = 0;
	}

	function updateMB(b)
	{
		switch(b)
		{
			case 0:
				document.getElementById('b0').disabled = true;
				document.getElementById('b1').disabled = false;
				document.getElementById('b2').disabled = false;
				document.getElementById('b3').disabled = false;
				mode = 0;
				for (let thing of document.getElementsByClassName('coola0'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}
				for (let thing of document.getElementsByClassName('coola1'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}

				for (let thing of document.getElementsByClassName('coola2'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola3'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				if (document.getElementById('inputfile').disabled)
				{
					document.getElementById('start').disabled = false;
					document.getElementById('start').style.opacity = 1;
				}
				break;
			case 1:
				document.getElementById('b0').disabled = false;
				document.getElementById('b1').disabled = true;
				document.getElementById('b2').disabled = false;
				document.getElementById('b3').disabled = false;
				mode = 1;
				for (let thing of document.getElementsByClassName('coola0'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola1'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}

				for (let thing of document.getElementsByClassName('coola2'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}
				for (let thing of document.getElementsByClassName('coola3'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				if (document.getElementById('inputfile').disabled)
				{
					document.getElementById('start').disabled = false;
					document.getElementById('start').style.opacity = 1;
				}
				break;
			case 2:
				document.getElementById('b0').disabled = false;
				document.getElementById('b1').disabled = false;
				document.getElementById('b2').disabled = true;
				document.getElementById('b3').disabled = false;
				mode = 2;
				for (let thing of document.getElementsByClassName('coola0'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}
				for (let thing of document.getElementsByClassName('coola1'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}

				for (let thing of document.getElementsByClassName('coola2'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola3'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}
				if (document.getElementById('inputfile').disabled)
				{
					document.getElementById('start').disabled = false;
					document.getElementById('start').style.opacity = 1;
				}
				break;
			case 3:
				document.getElementById('b0').disabled = false;
				document.getElementById('b1').disabled = false;
				document.getElementById('b2').disabled = false;
				document.getElementById('b3').disabled = true;
				mode = 3;
				for (let thing of document.getElementsByClassName('coola0'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola1'))
				{
					thing.style.opacity = 1;
					thing.disabled = false;
				}

				for (let thing of document.getElementsByClassName('coola2'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola3'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				if (document.getElementById('inputfile').disabled)
				{
					document.getElementById('start').disabled = false;
					document.getElementById('start').style.opacity = 1;
				}
				break;
			default:
				document.getElementById('b0').disabled = false;
				document.getElementById('b1').disabled = false;
				document.getElementById('b2').disabled = false;
				document.getElementById('b3').disabled = false;

				for (let thing of document.getElementsByClassName('coola0'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola1'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola2'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
				for (let thing of document.getElementsByClassName('coola3'))
				{
					thing.style.opacity = 0;
					thing.disabled = true;
				}
		}
	}
</script>


<script>
var options = {};
function convert()
{
	options = {
		mode: mode,
		ignorenote: document.getElementById('in').value,
		keycount: document.getElementById('kc').value,
		side: document.getElementById('s').value,
		player1: document.getElementById('p1').value,
		player2: document.getElementById('p2').value,
		player3: document.getElementById('p3').value,
		stage: document.getElementById('st').value,
		speed: document.getElementById('r0').value,
		bpm: document.getElementById('r1').value,
		needsvoices: document.getElementById('nv').value,
		gfsection: document.getElementById('gs').value,
		altanim: document.getElementById('aa').value,
		musthitsection: document.getElementById('mhs').value,
		audiofilename: document.getElementById('afn').value,
		artist: document.getElementById('ar').value,
		creator: document.getElementById('cr').value,
		version: document.getElementById('diff').value,
		hpdrainrate: document.getElementById('r2').value,
		hitsoundvolume: document.getElementById('r3').value,
		fromkeydefault: document.getElementById('fkd').value,
		tokeydefault: document.getElementById('tkd').value
	};
	console.log(options);
	switch (parseInt(options.mode))
	{
		case 1:
			data =  stringify(osu_to_fnf(parseTXT(data)), '\t', false);
			break;
		case 2:
			var ha = fnf_to_osu(parseJSON(data));
			data = [ha[0].join('\n'), ha[1]];
			break;
		case 3:
			var ha = osu_to_osu(parseTXT(data));
			data = [ha[0].join('\n'), ha[1]];
			break;
		default:
			data = stringify(fnf_to_fnf(parseJSON(data)), '\t', false);
			break;
	}
	document.getElementById('downloader').disabled = false;
	document.getElementById('downloader').style.left = 400;
	document.getElementById('downloader').style.opacity = 1;
}

function random(max)
{
	return Math.floor(Math.random() * max);
}

function fnf_to_fnf(map, fromkey = 0)
{
	console.log('Getting FNF map data...');
	var value = 0;
	for (i = 0; i < map.song.notes.length; i++)
		value += map.song.notes[i].sectionNotes.length;
	console.log('Found ' + value + ' notes (include event notes)');

	var from_key = 0;
	if (fromkey == 0)
	{
		var keys = [parseInt(options.fromkeydefault), parseInt(options.fromkeydefault)];
		if (map.song.playerKeyCount != null)
			keys[0] = parseInt(map.song.playerKeyCount);
		if (map.song.keyCount != null)
			keys[1] = parseInt(map.song.keyCount);
		if (map.song.mania != null)
			keys = [parseInt(map.song.mania) + 1, parseInt(map.song.mania) + 1];

		if (keys[0] != keys[1])
			 console.log('Charts/maps with different numbers of keys not supported! (you have ' + keys[0] + ' for opponent and ' + keys[1] + ' for player)');
		else
			from_key = keys[0];
	}
	else
		from_key = fromkey;

	var to_key = 0;
	if (parseInt(options.keycount) < 1 || parseInt(options.keycount) > algLength())
	{
		console.log('Key count ' + (parseInt(options.keycount) < 1 ? 'less than 1' : ('more than ' + algLength())) + ', returning ' + options.tokeydefault + '...');
		to_key = parseInt(options.tokeydefault);
	}
	else
		to_key = parseInt(options.keycount);

	if (from_key == to_key)
		 console.log('Chart/Map already is ' + from_key + ' key!');

	console.log('Converting notes...');
	for (let i = 0; i < map.song.notes.length; i++)
		for (let i1 = 0; i1 < map.song.notes[i].sectionNotes.length; i1++)
		{
			if (map.song.notes[i].sectionNotes[i1][1] >= 0)
			{
				var alg_var = alg(from_key, to_key)[map.song.notes[i].sectionNotes[i1][1]];
				try {
					if (alg_var.length > 1)
						map.song.notes[i].sectionNotes[i1][1] = parseInt(alg_var[random(alg_var.length)]);
					else if (alg_var.length == 1)
						map.song.notes[i].sectionNotes[i1][1] = parseInt(alg_var[0]);
					else
						map.song.notes[i].sectionNotes[i1][1] = parseInt(alg_var);
				}
				catch(e){
					 console.log('A problem occurred in parsing algorithm (try check a keyCount or mania count in chart): ' + e);
				}
			}
		}

	var inarray = options.ignorenote.split(',');
	if (inarray.length > 0)
	{
		console.log('Ignoring some notes...');
		for (let sr = 0; sr < inarray.length; sr++)
		{
			inarray[sr] = inarray[sr].trim();
			for (let i = 0; i < map.song.notes.length; i++)
			{
				var int = 0;
				var goodnotes = [];
				for (let i1 = 0; i1 < map.song.notes[i].sectionNotes.length; i1++)
					if (map.song.notes[i].sectionNotes[int][3] != inarray[sr])
					{
						goodnotes.push(map.song.notes[i].sectionNotes[int]);
						int++;
					}
				map.song.notes[i].sectionNotes = goodnotes;
			}
		}
	}
	
	/*var cooltimecheck = 0;
	for (let i = 0; i < map.song.notes.length; i++)
		if (map.song.notes[i] != null)
			cooltimecheck = cooltimecheck + (4 * (1000 * 60 / (map.song.notes[i].changeBPM ? map.song.notes[i].bpm : map.song.bpm)));
	console.log('Sections:' + map.song.notes.length + ' | Time:' + cooltimecheck);
	map.song.time = cooltimecheck;*/

	map.song.keyCount = parseInt(to_key);
	map.song.playerKeyCount = parseInt(to_key);
	map.song.mania = parseInt(to_key) - 1;

	console.log('Successfully converted FNF map ' + map.song.song + ' from ' + from_key + ' keys to ' + to_key + ' keys!');
	return map;
}

function osu_to_fnf(map)
{
	var json = { // copied from psych engine charting state
		song: {
			song: 'Sus',
			notes: [],
			events: [],
			bpm: parseInt(options.bpm),
			needsVoices: parseBool(options.needsvoices),
			player1: options.player1,
			player2: options.player2,
			gfVersion: options.player3,
			speed: parseFloat(options.speed),
			stage: options.stage,
			mania: 3,
			playerKeyCount: 4,
			keyCount: 4,
			validScore: false
		}
	};

	console.log('Getting osu! map data...');
	console.log('Found ' + (map.length - findLine(map, '[HitObjects]') + 1) + ' notes...');
	json.song.song = getMapOptions(map, 'Title');
	if (json.song.song == null)
		json.song.song = getMapOptions(map, 'TitleUnicode');
	if (json.song.song == null)
		json.song.song = 'Test';

	var curMode = parseInt(getMapOptions(map, 'Mode'));
	if (curMode != 3)
	{
		var osuModes = [
			'standard osu',
			'osu!taiko',
			'osu!catch',
			'osu!mania'
		];
		 console.log('Converter supports only osu!mania mode! You have a ' + osuModes[curMode] + ' beatmap.');
	}

	var toData = [];
	var int = 0;
	var keyCount = parseInt(getMapOptions(map, 'CircleSize'));
	if (keyCount > 10)
		 console.log('Converter from FNF supports not more 10 key! You have a ' + keyCount + ' key beatmap.');

	console.log('Parsing notes from osu!mania map...');
	for (let i = findLine(map, '[HitObjects]') + 1; i < map.length - 1; i++)
	{
		toData[int] = [
			parseInt(osuLine(map[i], 2, ',')),
			convertNote(osuLine(map[i], 0, ','), keyCount),
			parseFloat(osuLine(map[i], 5, ',')) - parseFloat(osuLine(map[i], 2, ','))
		];
		if (toData[int][2] < 0)
			toData[int][2] = 0; // removing negative values of hold notes
		int++;
	}
	int = 0;

	if ((findLine(map, '[TimingPoints]') + 1) != null)
	{
		console.log('Calculating BPM...');
		var bpm = 0;
		var bpmcount = 1;
		for (let i = findLine(map, '[TimingPoints]'); i < findLine(map, '[HitObjects]') - 2; i++)
			if (map[i].split(',')[6] == '1')
			{
				bpm = bpm + parseFloat(map[i].split(',')[1]);
				bpmcount++;
			}
		json.song.bpm = parseInt(bpm / bpmcount);
	}
	else
		console.log('Calculating BPM failed');

	console.log('Placing notes to FNF map...');
	/*for (let i = 0; i < toData.length; i++)
	{
		json.song.notes[0].sectionNotes[i] = toData[i]; // placing all notes in one section (very bad for charting state)
	}*/

	var sectnote = 0;
	for (let sect = 0;; sect++) // infinite loop xd
	{
		json.song.notes[sect] = {
			typeOfSection: 0,
			lengthInSteps: 16,
			sectionNotes: [],
			mustHitSection: parseBool(options.mustHitSection),
			gfSection: parseBool(options.gfSection),
			altAnim: parseBool(options.altAnim)
		};

		for (let note = 0; note < toData.length; note++)
		{
			if
			(
				toData[note][0] <= ((sect + 1) * (4 * (1000 * 60 / json.song.bpm))) &&
				toData[note][0] > ((sect) * (4 * (1000 * 60 / json.song.bpm)))
			)
			{
				json.song.notes[sect].sectionNotes[sectnote] = toData[note];
				sectnote++;
			}
		}
		sectnote = 0;

		if (toData[toData.length - 1] == json.song.notes[sect].sectionNotes[json.song.notes[sect].sectionNotes.length - 1])
			break; // or not? (check start of loop)
	}

	if (parseInt(options.keycount) != keyCount)
	{
		console.log('Map have ' + keyCount + ' keys, converting to ' + parseInt(options.keycount) + ' key...');
		json = fnf_to_fnf(json, keyCount);
	}

	json.song.keyCount = parseInt(options.keycount);
	json.song.playerKeyCount = parseInt(options.keycount);
	json.song.mania = parseInt(options.keycount) - 1;

	var pathto = (getMapOptions(map, 'Artist') != null ? getMapOptions(map, 'Artist') : getMapOptions(map, 'ArtistUnicode')) + ' - ' + (getMapOptions(map, 'Title') != null ? getMapOptions(map, 'Title') : getMapOptions(map, 'TitleUnicode')) + ' (' + getMapOptions(map, 'Creator') + ') [' + getMapOptions(map, 'Version') + ']';
	console.log('Successfully converted ' + pathto + ' from osu!mania to FNF!');

	return json;
}

function fnf_to_osu(map)
{
	console.log('Getting FNF map data...');

	var value = 0;
	for (let i = 0; i < map.song.notes.length; i++)
		value += map.song.notes[i].sectionNotes.length;
	console.log('Found ' + value + ' notes (include event notes)');

	console.log('Setting key count of map...');
	var keyCount = 4;
	if (map.song.playerKeyCount != null)
		keyCount = parseInt(map.song.playerKeyCount);
	if (map.song.keyCount != null)
		keyCount = parseInt(map.song.keyCount);
	if (map.song.mania != null)
		keyCount = parseInt(map.song.mania) + 1;

	console.log('Setting values of osu map...');
	var osuformat = [
		'osu file format v14',
		'',
		'[General]',
		'AudioFilename: ' + options.audiofilename,
		'Mode: 3',
		'',
		'[Metadata]',
		'Title:' + makeSongName(map.song.song.toString(), '-', ' '),
		'Artist:' + options.artist,
		'Creator:' + options.creator,
		'Version:' + options.version,
		//'Source:' + options.source,
		'',
		'[Difficulty]',
		'HPDrainRate:' + options.hpdrainrate,
		'CircleSize:' + parseInt(options.keycount),
		'',
		'[TimingPoints]',
		'0,' + (60000 / parseFloat(map.song.bpm)) + ',4,0,0,' + options.hitsoundvolume + ',1,0',
		'',
		'[HitObjects]'
	];
	var notes = [];
	var int = 0;

	console.log('Calculating BPM...');
	var bpms = [];
	for (let sect = 0; sect < map.song.notes.length; sect++)
	{
		if
		(
			(map.song.notes[sect].changeBPM && map.song.notes[sect].bpm != null) ||
			(sect != 0 && map.song.notes[sect].bpm != null && map.song.notes[sect - 1].bpm != null && map.song.notes[sect - 1].bpm != map.song.notes[sect].bpm) ||
			(sect == 0 && map.song.notes[sect].bpm != null && map.song.bpm != map.song.notes[sect].bpm)
		)
			bpms.push([(sect + 1) * (4 * (1000 * 60 / (map.song.notes[sect].bpm))), map.song.notes[sect].bpm]);
	}

	if (bpms.length < 1)
		console.log('No BPM changes found');
	else
	{
		var vhs = options.hitsoundvolume;
		for (let i = 0; i < bpms.length; i++)
			osuformat.splice((findLine(osuformat, '[TimingPoints]') + i + 2), 0, (bpms[i][0] + ',' + (60000 / parseFloat(bpms[i][1])) + ',4,0,0,' + vhs + ',1,0'));
	}

	/*osuformat.splice(findLine(osuformat, '[TimingPoints]') - 1, 0, '[Events]');
	osuformat.splice(findLine(osuformat, '[Events]') + 1, 0, '0,0,"' + options.getOption('Background') + '",0,0');
	osuformat.splice(findLine(osuformat, '[Events]'), 0, '');
	if (options.getOption('Background') == 'none' || !options.getOption('Background').includes('.'))
		osuformat.splice(findLine(osuformat, '[Events]'), 3);*/

	console.log('Converting notes...');
	if (parseInt(options.keycount) != keyCount)
	{
		console.log('Map have ' + keyCount + ' keys, converting to ' + parseInt(options.keycount) + ' key...');
		map = fnf_to_fnf(map, keyCount);
	}

	var inarray = options.ignorenote.split(',');
	if (inarray.length > 0)
	{
		console.log('Ignoring some notes...');
		for (let sr = 0; sr < inarray.length; sr++)
		{
			inarray[sr] = inarray[sr].trim();
			for (let i = 0; i < map.song.notes.length; i++)
			{
				var int1 = 0;
				var goodnotes = [];
				for (let i1 = 0; i1 < map.song.notes[i].sectionNotes.length; i1++)
					if (map.song.notes[i].sectionNotes[int1][3] != inarray[sr])
					{
						goodnotes.push(map.song.notes[i].sectionNotes[int1]);
						int1++;
					}
				map.song.notes[i].sectionNotes = goodnotes;
			}
		}
	}

	var osu_side = parseInt(options.side);
	switch (osu_side)
	{
		case 1:
			console.log('Current side: BF');
			break;
		case 2:
			console.log('Current side: Opponent');
			break;
		default:
			console.log('Current side: All (BF and opponent)');
	}
	for (let i = 0; i < map.song.notes.length; i++)
		for (let i1 = 0; i1 < map.song.notes[i].sectionNotes.length; i1++)
		{
			if (map.song.notes[i].sectionNotes[i1][1] >= 0)
			{
				var note = 0;
				switch (osu_side)
				{
					case 1:
						if (map.song.notes[i].mustHitSection)
						{
							if (map.song.notes[i].sectionNotes[i1][1] >= 0 && map.song.notes[i].sectionNotes[i1][1] < keyCount)
							{
								note = convertNote(map.song.notes[i].sectionNotes[i1][1], parseInt(options.keycount), false);
								var timing = parseInt(map.song.notes[i].sectionNotes[i1][0]);
								var isHold = 1;
								var timing_hold = '0';
								if (map.song.notes[i].sectionNotes[i1][2] > 0)
								{
									isHold = 128;
									timing_hold = (parseInt(map.song.notes[i].sectionNotes[i1][0]) + parseInt(map.song.notes[i].sectionNotes[i1][2])) + ':0';
								}
								notes[int] = note + ',192,' + timing + ',' + isHold + ',0,' + timing_hold + ':0:0:0:';
								int++;
							}
						}
						else
						{
							if (map.song.notes[i].sectionNotes[i1][1] >= keyCount)
							{
								note = convertNote(map.song.notes[i].sectionNotes[i1][1] - keyCount, parseInt(options.keycount), false);
								var timing = parseInt(map.song.notes[i].sectionNotes[i1][0]);
								var isHold = 1;
								var timing_hold = '0';
								if (map.song.notes[i].sectionNotes[i1][2] > 0)
								{
									isHold = 128;
									timing_hold = (parseInt(map.song.notes[i].sectionNotes[i1][0]) + parseInt(map.song.notes[i].sectionNotes[i1][2])) + ':0';
								}
								notes[int] = note + ',192,' + timing + ',' + isHold + ',0,' + timing_hold + ':0:0:0:';
								int++;
							}
						}
						break;
					case 2:
						if (map.song.notes[i].mustHitSection)
						{
							if (map.song.notes[i].sectionNotes[i1][1] >= keyCount)
							{
								note = convertNote(map.song.notes[i].sectionNotes[i1][1] - keyCount, parseInt(options.keycount), false);
								var timing = parseInt(map.song.notes[i].sectionNotes[i1][0]);
								var isHold = 1;
								var timing_hold = '0';
								if (map.song.notes[i].sectionNotes[i1][2] > 0)
								{
									isHold = 128;
									timing_hold = (parseInt(map.song.notes[i].sectionNotes[i1][0]) + parseInt(map.song.notes[i].sectionNotes[i1][2])) + ':0';
								}
								notes[int] = note + ',192,' + timing + ',' + isHold + ',0,' + timing_hold + ':0:0:0:';
								int++;
							}
						}
						else
						{
							if (map.song.notes[i].sectionNotes[i1][1] >= 0 && map.song.notes[i].sectionNotes[i1][1] < keyCount)
							{
								note = convertNote(map.song.notes[i].sectionNotes[i1][1], parseInt(options.keycount), false);
								var timing = parseInt(map.song.notes[i].sectionNotes[i1][0]);
								var isHold = 1;
								var timing_hold = '0';
								if (map.song.notes[i].sectionNotes[i1][2] > 0)
								{
									isHold = 128;
									timing_hold = (parseInt(map.song.notes[i].sectionNotes[i1][0]) + parseInt(map.song.notes[i].sectionNotes[i1][2])) + ':0';
								}
								notes[int] = note + ',192,' + timing + ',' + isHold + ',0,' + timing_hold + ':0:0:0:';
								int++;
							}
						}
						break;
					default:
						if (map.song.notes[i].sectionNotes[i1][1] >= 0)
						{
							note = convertNote(map.song.notes[i].sectionNotes[i1][1], parseInt(options.keycount), false);
							var timing = parseInt(map.song.notes[i].sectionNotes[i1][0]);
							var isHold = 1;
							var timing_hold = '0';
							if (map.song.notes[i].sectionNotes[i1][2] > 0)
							{
								isHold = 128;
								timing_hold = (parseInt(map.song.notes[i].sectionNotes[i1][0]) + parseInt(map.song.notes[i].sectionNotes[i1][2])) + ':0';
							}
							notes[int] = note + ',192,' + timing + ',' + isHold + ',0,' + timing_hold + ':0:0:0:';
							int++;
						}
				}
			}
		}
	var osuformat_length = osuformat.length;
	for (let i = 0; i < notes.length; i++)
		osuformat[osuformat_length + i] = notes[i];

	var pathto = (getMapOptions(osuformat, 'Artist') != null ? getMapOptions(osuformat, 'Artist') : getMapOptions(osuformat, 'ArtistUnicode')) + ' - ' + (getMapOptions(osuformat, 'Title') != null ? getMapOptions(osuformat, 'Title') : getMapOptions(osuformat, 'TitleUnicode')) + ' (' + getMapOptions(osuformat, 'Creator') + ') [' + getMapOptions(osuformat, 'Version') + ']';
	console.log('Successfully converted ' + pathto + ' from FNF to osu!mania!');

	return [osuformat, pathto];
}

function osu_to_osu(map_)
{
	console.log('Getting osu! map data...');
	console.log('Found ' + (map_.length - findLine(map_, '[HitObjects]') + 1) + ' notes...');

	var curMode = parseInt(getMapOptions(map_, 'Mode'));
	if (curMode != 3)
	{
		var osuModes = [
			'standard osu',
			'osu!taiko',
			'osu!catch',
			'osu!mania'
		];
		 console.log('Converter supports only osu!mania mode! You have a ' + osuModes[curMode] + ' beatmap.');
	}

	console.log('Setting key count...');
	var from_key = parseInt(getMapOptions(map_, 'CircleSize'));
	if (from_key > 10)
		 console.log('Converter supports not more 10 key! You have a ' + keyCount + ' key beatmap.');
	var to_key = 0;
	if (parseInt(options.keycount) < 1 || parseInt(options.keycount) > algLength())
	{
		console.log('Key count ' + (parseInt(options.keycount) < 1 ? 'less than 1' : ('more than ' + algLength())) + ', returning ' + options.tokeydefault + '...');
		to_key = options.tokeydefault;
	}
	else
		to_key = parseInt(options.keycount);

	if (from_key == to_key)
		 console.log('Chart/Map already is ' + from_key + ' key!');

	var map = [];
	for (let i = 0; i < findLine(map_, '[HitObjects]') + 1; i++)
		map[i] = map_[i];
	for (let i = findLine(map_, '[HitObjects]') + 1; i < map_.length; i++)
		map[i] = map_[i].split(',');

	console.log('Converting notes...');
	for (let i = findLine(map, '[HitObjects]') + 1; i < map.length - 1; i++)
	{
		var alg_var = alg(from_key, to_key)[convertNote(map[i][0], from_key, true)];
		if (alg_var.length > 1)
			map[i][0] = convertNote(parseInt(alg_var[random(alg_var.length)]), to_key, false);
		else if (alg_var.length == 1)
			map[i][0] = convertNote(parseInt(alg_var[0]), to_key, false);
		else
			map[i][0] = convertNote(parseInt(alg_var), to_key, false);
		map[i] = map[i].join(',');
	}

	map[findLine(map, 'CircleSize')] = 'CircleSize:' + to_key;
	if (findLine(map, 'BeatmapID') != -1)
		map[findLine(map, 'BeatmapID')] = 'BeatmapID:0';
	else
		map[findLine(map, 'Version') + 1] = 'BeatmapID:0';
	
	if (findLine(map, 'BeatmapSetID') != -1)
		map[findLine(map, 'BeatmapSetID')] = 'BeatmapSetID:-1';
	else
		map[findLine(map, 'BeatmapID') + 1] = 'BeatmapSetID:-1';

	var pathto = (getMapOptions(map, 'Artist') != null ? getMapOptions(map, 'Artist') : getMapOptions(map, 'ArtistUnicode')) + ' - ' + (getMapOptions(map, 'Title') != null ? getMapOptions(map, 'Title') : getMapOptions(map, 'TitleUnicode')) + ' (' + getMapOptions(map, 'Creator') + ') [' + getMapOptions(map, 'Version') + ']';
	console.log('Successfully converted osu!mania beatmap ' + pathto + ' from ' + from_key + 'k to ' + to_key + 'k!');

	return [map, pathto];
}

function parseTXT(path)
{
	var daList = [];
	daList = path.split('\n');
	for (let i = 0; i < daList.length; i++)
		daList[i] = daList[i].trim();
	return daList;
}
function parseJSON(path)
{
	try
	{
		return JSON.parse(path);
	}
	catch (e)
	{
		console.log('Can\'t parse ' + path + ', ' + e);
		return 228;
	}
}

function stringify(path, string = "\t")
{
	return JSON.stringify(path, null, string);
}


function alg(from_key, to_key)
{
	var algpr = [
		'','0,0\n0,1\n0/1,2/3\n0/1/2,3/4/5\n0/1/2/3,4/5/6/7\n0/1/2/3/4,5/6/7/8/9\n0/1/2/3/4/5,6/7/8/9/10/11\n0/1/2/3/4/5/6,7/8/9/10/11/12/13\n0/1/2/3/4/5/6/7,8/9/10/11/12/13/14/15\n0/1/2/3/4/5/6/7/8,9/10/11/12/13/14/15/16/17',
		'0,0,0,0\n0,0,1,1\n0,1,2,3\n0/1,2,3/4,5\n0/1,2/3,4/5,6/7\n0/1/2,3/4,5/6/7,8/9\n0/1/2,3/4/5,6/7/8,9/10/11\n0/1/2/3,4/5/6,7/8/9/10,11/12/13\n0/1/2/3,4/5/6/7,8/9/10/11,12/13/14/15\n0/1/2/3/4,5/6/7/8,9/10/11/12/13,14/15/16/17',
		'0,0,0,0,0,0\n0,0,0,1,1,1\n0,0,1,2,2,3\n0,1,2,3,4,5\n0/1,2,3,4/5,6,7\n0/1,2,3/4,5/6,7,8/9\n0/1,2/3,4/5,6/7,8/9,10/11\n0/1,2/3/4,5/6,7/8,9/10/11,12/13\n0/1/2,3/4,5/6/7,8/9/10,11/12,13/14/15\n0/1/2,3/4/5,6/7/8,9/10/11,12/13/14,15/16/17',
		'0,0,0,0,0,0,0,0\n0,0,0,0,1,1,1,1\n0,0,1,1,2,2,3,3\n0,0,1,2,3,3,4,5\n0,1,2,3,4,5,6,7\n0,1,2/3,4,5,6,7/8,9\n0/3,4,1,2/5,6/9,10,7,8/11\n0/4,5,1/3,2/6,7/11,12,8/10,9/13\n0/4,1/5,2/6,3/7,8/12,9/13,10/14,11/15\n0/5,1/6,2/4/7,3/8,9/14,10/15,11/13/16,12/17',
		'0,0,0,0,0,0,0,0,0,0\n0,0,0,0,0,1,1,1,1,1\n0,0,0,1,1,2,2,2,3,3\n0,0,1,2,2,3,3,4,5,5\n0,1,2,2,3,4,5,6,6,7\n0,1,2,3,4,5,6,7,8,9\n3,4,1,0,2/5,9,10,7,6,8/11\n0/4,5,1,3,2/6,7/11,12,8,10,9/13\n0/4,1/5,2,6,3/7,8/12,9/13,10,14,11/15\n0/5,1/6,4,2/7,3/8,9/14,10/15,13,11/16,12/17',
		'0,0,0,0,0,0,0,0,0,0,0,0\n0,0,0,0,0,0,1,1,1,1,1,1\n0,0,0,1,1,1,2,2,2,3,3,3\n0,0,1,1,2,2,3,3,4,4,5,5\n0,2,3,0,1,3,4,6,7,4,5,7\n3,2,4,0,1,4,8,7,9,5,6,9\n0,1,2,3,4,5,6,7,8,9,10,11\n0,1/3,2,4,5,6,7,8/10,9,11,12,13\n0,1/5,3,4,2/6,7,8,9/13,11,12,10/14,15\n0,1/6,3,5,2/4/7,8,9,10/15,12,14,11/13/16,17',
		'0,0,0,0,0,0,0,0,0,0,0,0,0,0\n0,0,0,0,0,0,0,1,1,1,1,1,1,1\n0,0,0,0,1,1,1,2,2,2,2,3,3,3\n0,0,1,1,1,2,2,3,3,4,4,4,5,5\n0,2,3,2,0,1,3,4,6,7,6,4,5,7\n0,2,4,3,0,1,4,5,7,9,8,5,6,9\n0,1,2,1,3,4,5,6,7,8,7,9,10,11\n0,1,2,3,4,5,6,7,8,9,10,11,12,13\n0,1/5,3,4,2,6,7,8,9/13,11,12,10,14,15\n0,1/6,3,4,5,2/7,8,9,10/15,12,13,14,11/16,17',
		'0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\n0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1\n0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3\n0,0,0,1,1,2,2,2,3,3,3,4,4,5,5,5\n0,1,2,3,0,1,2,3,4,5,6,7,4,5,6,7\n0,1,2,4,0,1,3,4,5,6,7,9,5,6,8,9\n0,1,4,2,3,1,4,5,6,7,10,8,9,7,10,11\n0,1,4,2,3,1,5,6,7,8,11,9,10,8,12,13\n0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n0,1,2/4,3,5,6,7,8,9,10,11/13,12,14,15,16,17',
	'0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\n0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1\n0,0,0,0,0,1,1,1,1,2,2,2,2,2,3,3,3,3\n0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5\n0,1,2,3,2,0,1,2,3,4,5,6,7,6,4,5,6,7\n0,1,3,4,2,0,1,3,4,5,6,8,9,7,5,6,8,9\n0,1,4,2,4,3,1,4,5,6,7,10,8,10,9,7,10,11\n0,1,5,2,3,4,1,5,6,7,8,12,9,10,11,8,12,13\n0,1,2,3,2,4,5,6,7,8,9,10,11,10,12,13,14,15\n0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17'
	];
	var alg = algpr[from_key].split('\n');
	var alg2 = alg[to_key].split(',');
	var alg3 = [];
	for (i = 0; i < alg2.length; i++)
		alg3[i] = alg2[i].split('/');
	return alg3;
}

function algLength()
{
	return 9;
}

// from funkin coolutil.hx
function numberArray(min, max)
{
	var dumbArray = [];
	for (let i = min; i < max + 1; i++)
		dumbArray.push(i);

	return dumbArray;
}

function getVersion(){return '1.4';}

function convertNote(from_note, keyCount, fromosu = true)
{
	from_note = parseInt(from_note);
	var note_array = [
		[
			numberArray(0, 511) // 0 key
		],
		[
			numberArray(0, 511),
			numberArray(0, 511)
		],
		[
			numberArray(0, 256), numberArray(257, 511),
			numberArray(0, 256), numberArray(257, 511)
		],
		[
			numberArray(0, 169), numberArray(170, 340), numberArray(341, 511),
			numberArray(0, 169), numberArray(170, 340), numberArray(341, 511)
		],
		[
			numberArray(0, 127), numberArray(128, 255), numberArray(256, 383), numberArray(384, 511), // 4 key bf
			numberArray(0, 127), numberArray(128, 255), numberArray(256, 383), numberArray(384, 511) // 4 key opponent
		],
		[
			numberArray(0, 101), numberArray(102, 203), numberArray(204, 306), numberArray(307, 408), numberArray(409, 511),
			numberArray(0, 101), numberArray(102, 203), numberArray(204, 306), numberArray(307, 408), numberArray(409, 511)
		],
		[
			numberArray(0, 84), numberArray(85, 169), numberArray(170, 255), numberArray(256, 340), numberArray(341, 425), numberArray(426, 511),
			numberArray(0, 84), numberArray(85, 169), numberArray(170, 255), numberArray(256, 340), numberArray(341, 425), numberArray(426, 511)
		],
		[
			numberArray(0, 72), numberArray(73, 145), numberArray(146, 218), numberArray(219, 291), numberArray(292, 364), numberArray(365, 437), numberArray(438, 511),
			numberArray(0, 72), numberArray(73, 145), numberArray(146, 218), numberArray(219, 291), numberArray(292, 364), numberArray(365, 437), numberArray(438, 511)
		],
		[
			numberArray(0, 63), numberArray(64, 127), numberArray(128, 191), numberArray(192, 255), numberArray(256, 319), numberArray(320, 383), numberArray(384, 447), numberArray(448, 511),
			numberArray(0, 63), numberArray(64, 127), numberArray(128, 191), numberArray(192, 255), numberArray(256, 319), numberArray(320, 383), numberArray(384, 447), numberArray(448, 511)
		],
		[
			numberArray(0, 56), numberArray(57, 113), numberArray(114, 170), numberArray(171, 227), numberArray(228, 284), numberArray(285, 341), numberArray(342, 398), numberArray(399, 455), numberArray(456, 511),
			numberArray(0, 56), numberArray(57, 113), numberArray(114, 170), numberArray(171, 227), numberArray(228, 284), numberArray(285, 341), numberArray(342, 398), numberArray(399, 455), numberArray(456, 511)
		],
		[
			numberArray(0, 50), numberArray(51, 101), numberArray(102, 152), numberArray(153, 203), numberArray(204, 254), numberArray(255, 305), numberArray(306, 356), numberArray(357, 407), numberArray(408, 458), numberArray(459, 511),
			numberArray(0, 50), numberArray(51, 101), numberArray(102, 152), numberArray(153, 203), numberArray(204, 254), numberArray(255, 305), numberArray(306, 356), numberArray(357, 407), numberArray(408, 458), numberArray(459, 511)
		]
	];

	if (fromosu)
	{
		for (let i = 0; i < note_array[keyCount].length; i++)
			for (let i2 = 0; i2 < note_array[keyCount][i].length; i2++)
				if (note_array[keyCount][i][i2] == from_note)
					return i;
	}
	else
	{
		return note_array[keyCount][from_note][parseInt(note_array[keyCount][from_note].length / 2)];
	}

	console.log('Note ' + from_note + ' not found in array!');
	return 0;
}

function findLine(array, find, fromLine = 0, toLine = null)
{
	if (toLine == null)
		toLine = array.length;

	for (let i = fromLine; i < toLine; i++)
		if (array[i].includes(find))
			return i;

	console.log('String ' + find + ' not found!');
	return -1;
}

function osuLine(string, int, split)
{
	var array = string.split(split);
	return array[int];
}

function getMapOptions(map, name)
{
	for (let i = 0; i < map.length; i++)
		if (map[i].toLowerCase().startsWith(name.toLowerCase() + ':'))
			return map[i].substring(map[i].lastIndexOf(':') + 1).trim(); 

	console.log('Map option ' + name + ' not found!');
	return null;
}

function makeSongName(string, toreplace, replacer)
{
	var string2 = [];
	for (let i = 0; i < string.length; i++)
		string2[i] = string[i].replace(toreplace, replacer);

	for (let i = 0; i < string2.length; i++)
	{
		if (i == 0)
		{
			string2[i] = string2[i].toUpperCase();
		}
		else
		{
			if (string2[i] == replacer && i != string2.length - 1)
				string2[i + 1] = string2[i + 1].toUpperCase();
			else
			string2[i] = string2[i];
		}
	}
	return string2.join('');
}
</script>